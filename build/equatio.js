function g(b){var c="",a,d,y,e,f,l=0;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<b.length;)a=this.b.indexOf(b.charAt(l++)),d=this.b.indexOf(b.charAt(l++)),e=this.b.indexOf(b.charAt(l++)),f=this.b.indexOf(b.charAt(l++)),a=a<<2|d>>4,d=(d&15)<<4|e>>2,y=(e&3)<<6|f,c+=String.fromCharCode(a),64!=e&&(c+=String.fromCharCode(d)),64!=f&&(c+=String.fromCharCode(y));b=c;c="";for(f=c1=c2=e=0;e<b.length;)f=b.charCodeAt(e),128>f?(c+=String.fromCharCode(f),e++):191<f&&224>f?(c2=b.charCodeAt(e+1),c+=String.fromCharCode((f&
31)<<6|c2&63),e+=2):(c2=b.charCodeAt(e+1),c3=b.charCodeAt(e+2),c+=String.fromCharCode((f&15)<<12|(c2&63)<<6|c3&63),e+=3);return c};var h={"munching squares":["(x^y)*(t/100)"],"munching triangles":["(x&y)*(t/100)"],noise:["(function(){var n=Math.random()*0xFF;return n<<16|n<<8|n;})()","Math.random()*255",1,0.3],mandelbrot:["(function(){var it;var jx=jy=0.0;for(it=0;it<10&&jx*jx+jy*jy<=4;++it){var tmp=2*jx*jy;jx=jx*jx-jy*jy+(-2+3*x/255);jy=tmp+(-1+2*y/255);};return Math.pow(it,5);})()"],unnamed1:["x<<t>>y","s<<t>>s",1,0.3],tejeez:["(((50*s)/50)*(((50*s)/50)>>5|(s)>>8))>>((50*s/50)>>16)*(x^y)","(((50*s)/50)*(((50*s)/50)>>5|(s)>>8))>>((50*s/50)>>16)"]};
function k(){for(var b in h)h.hasOwnProperty(b)&&$("<option>"+b+"</option>").h($("#examples"))};var m,n,p,q=!0;function r(){}
function s(b){$("#gfxerror").a("color","#050");if(""==b)$("#gfxerror").text("No code"),t();else{try{eval(b)}catch(c){var a=c.message.split(" ")[0];if(!u.hasOwnProperty(a)&&"rd"!=a){t();$("#gfxerror").a("color","#900").text(c.message);return}}r=new Function("var s = E.vars.s, t = E.vars.t, td = E.vars.td, mx = E.vars.mx, my = E.vars.my;        var rd = Math.random()*256, mld = E.vars.mld, mrd = E.vars.mrd, mmd = E.vars.mmd;        for (var y = 0; y < 256; y++) {            for (var x = 0; x < 256; x++) {                E.graphics.data[y * 256 + x] = (255 << 24) | ("+b+
");            }        }        E.graphics.imageData.data.set(E.graphics.buffer8);        E.graphics.context.putImageData(E.graphics.imageData, 0, 0);");try{r(),$("#gfxerror").text("No error"),q||m.clearRect(0,0,256,256)}catch(d){t(),$("#gfxerror").a("color","#900").text(d.message)}}}function t(){r=function(){};m.clearRect(0,0,256,256)};var v,w,x,z=!1,A=!1;function B(){A||(v.f(w.e),A=!0)}
function C(b){$("#sfxerror").a("color","#050");if(""==b)$("#sfxerror").text("No code"),D();else{try{eval(b)}catch(c){if(!u.hasOwnProperty(c.message.split(" ")[0])){D();$("#sfxerror").a("color","#900").text(c.message);return}}E.prototype.c=new Function("inputBuffers","outputBuffers","var s = E.vars.s, t = E.vars.t, td = E.vars.td, mx = E.vars.mx, my = E.vars.my;        var mld = E.vars.mld, mrd = E.vars.mrd, mmd = E.vars.mmd;        var output = this.outputs[0];        for (var i = 0; i < output.samples.length; i++) {            output.samples[i] = ("+b+
") % 256 / 256;            s++;        }        E.vars.s = s;");try{x.c(),$("#sfxerror").text("No error")}catch(a){D(),$("#sfxerror").a("color","#900").text(a.message)}}}function D(){E.prototype.c=function(){}}function E(b){AudioletNode.call(this,b,0,2);this.i(0,2)}extend(E,AudioletNode);E.prototype.c=function(){};E.prototype.toString=function(){return"EquatioNode"};var F=0,G=1,u={},H=!1;
$(function(){I();k();m=$("#screen")[0].getContext("2d");n=m.getImageData(0,0,256,256);p=new ArrayBuffer(n.data.length);new Uint8ClampedArray(p);new Uint32Array(p);w=new Audiolet;v=new Gain(w);x=new E(w);x.f(v);v.value.g(0.5);setTimeout(function(){$("#speed").d("setValue",1);$("#volume").d("setValue",0.5);var b=document.location.search;if(""!=b)for(var b=b.substring(1),b=b.split("&"),c=0;c<b.length;++c){var a=b[c].split("=")[0],d=b[c].split("=")[1];"false"==d?d=!1:"true"==d?d=!0:(nvalue=parseFloat(d),
d=isNaN(nvalue)?g(decodeURIComponent(d)):nvalue);console.log(a,d);switch(a){case "gfx":(q=a=d)?r():m.clearRect(0,0,256,256);$("#gfxactive")[0].checked=a;break;case "sfx":(a=d)?B():(v.disconnect(w.e),A=!1);z=a;$("#sfxactive")[0].checked=a;break;case "gfxcode":s(d);$("#gfxcode")[0].value=d;break;case "sfxcode":C(d);$("#sfxcode")[0].value=d;break;case "paused":a:{a=d;if(null==a)a=!H;else if(a==H)break a;a?(v.disconnect(w.e),A=!1):(requestAnimationFrame(J),z&&B());H=a;$("#playbutton")[0].src=a?"img/play.png":
"img/pause.png"}break;case "volume":a=d;$("#volume").d("setValue",a);v.value.g(a);break;case "td":a=d;$("#speedview").text(Math.round(10*a)/10+"x");$("#speed").d("setValue",a);G=a;break;case "t":F=d,$("#time").text(Math.floor(d/60)+" sec")}}},200);$("#sharebutton");$("#resetbutton");$("#playbutton");$("#backbutton");$("#screen");$("#screen");$("#screen");$("#screen");$("#screen");$("#examples");$("#gfxactive");$("#sfxactive");$("#volume");$("#speed");$("#gfxcode");$("#sfxcode");requestAnimationFrame(J)});
function J(){F+=G;q&&r();$("#time").text(Math.floor(F/60)+" sec");H||requestAnimationFrame(J)}
function I(){for(var b=0,c=["ms","moz","webkit","o"],a=0;a<c.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var c=(new Date).getTime(),e=Math.max(0,16-(c-b)),f=window.setTimeout(function(){a(c+e)},e);b=c+e;return f});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})};
